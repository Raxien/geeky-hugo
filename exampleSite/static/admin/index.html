<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="robots" content="noindex" />
    <title>Content Manager</title>
    <script src="https://identity.netlify.com/v1/netlify-identity-widget.js"></script>
  </head>
  <body>
    <script src="https://unpkg.com/decap-cms@^3.2.0/dist/decap-cms.js"></script>
    <script>

      // Custom widget per shortcode citazione
      CMS.registerEditorComponent({
        id: "citazione",
        label: "Citazione Centrata",
        fields: [
          {
            name: 'text',
            label: 'Testo Citazione',
            widget: 'string',
            hint: 'Il testo da evidenziare come citazione'
          }
        ],
        pattern: /^{{<\s*citazione\s+"([^"]*)"\s*>}}$/,
        fromBlock: function(match) {
          return {
            text: match[1] || ''
          };
        },
        toBlock: function(obj) {
          return `{{< citazione "${obj.text}" >}}`;
        },
        toPreview: function(obj) {
          return h('div', {
            style: {
              border: '2px dashed #6f42c1',
              padding: '10px',
              borderRadius: '4px',
              backgroundColor: '#f8f7ff',
              color: '#333',
              textAlign: 'center',
              fontStyle: 'italic'
            }
          }, [
            h('strong', null, 'ðŸ’¬ Citazione: '),
            h('span', null, `"${obj.text}"`)
          ]);
        }
      });

      CMS.init();
    </script>
  </body>
</html>